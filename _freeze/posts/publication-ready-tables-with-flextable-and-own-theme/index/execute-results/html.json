{
  "hash": "06049a3d429667d1a0de0b630ded23ab",
  "result": {
    "markdown": "---\ntitle: \"Publication-ready tables with flextable and own theme in R\"\nauthor: \"Michael Dismorr\"\ndate: \"2021-11-23\"\ndate-modified: \"2024-06-01\"\ncategories: [R, publication-ready, tableone, flextable, tables]\nimage: tableone.png\n---\n\n\nIn this post, I will show you how to make publication-ready using a combination of the [`flextable`](https://cran.r-project.org/package=flextable) package and a function I've written to customize them according to my default layout. This will minimize the need to edit in MS Word, and copy and paste from Excel to Word when exporting tables from R. In this example, I will use the [`tableone`](https://cran.r-project.org/package=tableone) package to show how my `customtab()` function can be used to export Table 1.   \n\nThe [`flextable`](https://cran.r-project.org/package=flextable) package is a great package to generate word tables from R output. Together with the [`officer`](https://cran.r-project.org/package=officer) package from the same creator, it allows you to make most of the customization needed immediately in R, and thus let's you skip this potentially annoying step in MS Word. The [`tableone`](https://cran.r-project.org/package=tableone) package is a great package for, you guessed it, generating Table 1s. It allows for p-value calculations, SMDs, and generally just the output that you need. \n\nFor demonstration, I will use the `gbsg` dataset from the from the [`survival`](https://cran.r-project.org/package=survival) package. If you just want to try out the `customtab()` function, it can be downloaded [here](customtab.R).  \n\nOK, let's begin!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival) # only needed for the dataset in this example\nlibrary(dplyr) # to modify the needed dataframe\nlibrary(tibble) # for rownames_to_column() function\nlibrary(stringr) # for str_squish()\nlibrary(flextable)\nlibrary(officer)\nlibrary(forcats)\nlibrary(tableone)\nsource(\"customtab.R\")\n```\n:::\n\n\nLoad the dataset:  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbreast <- survival::gbsg\n```\n:::\n\n\nRunning `?survival::gbsg` gives:\n\n> The gbsg data set contains patient records from a 1984 â€” 1989 trial conducted by the German Breast Cancer Study Group (GBSG) of 720 patients with node positive cancer...  \n\nVariable | Explanation\n-------- | ------------\npid   | Patiend ID\nage | Age in years\nmeno | Menopausal staus - 0 = premenopaus, 1 = postmenopaus\nsize | tumor size\ngrade | tumor grade\nnodes | number of positive lymph nodes\npgr | progesterone receptors (fmol/L)\ner | estrogen receptors (fmol/L)\nhormon | hormone therapy - 0 = no, 1 = yes\nrfstime | recurrence free survival time in days\nstatus | 0 = alive without recurrence, 1 = recurrence or death\n\nSelect variables included in Table 1. \n\n::: {.cell}\n\n```{.r .cell-code}\nvariables <- names(breast)\n\nbreast <- breast %>% select(all_of(variables)) %>% \n  select(-pid, -rfstime, -status)\n\nbreast <- breast %>% mutate(meno = as_factor(meno), \n                            grade = as_factor(grade), \n                            hormon = as_factor(hormon))\n```\n:::\n\n\nRename the variables as they should appear in the table. While `tableone` can add explanation for you, I genereally prefer to type them out myself to keep track of what I actually want to get (e.g. is it mean or median?)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbreast <- breast %>% rename(`Age, years (mean (SD))` = age, \n                             Postmenopausal = meno, \n                             `Tumor size, mm (mean (SD)` = size, \n                             `Tumor grade` = grade, \n                             `Positive lymph nodes, (n)` = nodes, \n                             `Progesterone receptors, fmol/L (median [IQR])` = pgr, \n                             `Estrogen receptors, fmol/L (median [IQR])` = er, \n                             `Hormone treatment` = hormon)\n```\n:::\n\n\nRelabel hormon variable to more text friendly labels\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbreast$`Hormone treatment` <- breast$`Hormone treatment` %>% \n  fct_recode(Treated = \"1\", Placebo = \"0\")\n```\n:::\n\n\nSelect all variables and specify categorical variables for `tableone`\n\n::: {.cell}\n\n```{.r .cell-code}\n# All variables excluding the group variable\nmyVars <- breast %>% select(-`Hormone treatment`) %>% names() \n\n# All categorical variables\ncatVars <-  breast %>% select(where(is.factor)) %>% \n  dplyr::select(-`Hormone treatment`) %>% names()\n```\n:::\n\n\nCreate Table 1 object\n\n::: {.cell}\n\n```{.r .cell-code}\ntab1 <- breast %>% CreateTableOne(vars = myVars, \n                   data = . , \n                   factorVars = catVars, \n                   strata = \"Hormone treatment\", \n                   addOverall = T, \n                   test = T)\n```\n:::\n\n\nPrint Table 1 object to control output, e.g. remove missing, print non-normal variables correctly etc. \n\n::: {.cell}\n\n```{.r .cell-code}\ntab1_word <- print(tab1, \n                   nonnormal = c(\"Progesterone receptors, fmol/L (median [IQR])\", \n                                 \"Estrogen receptors, fmol/L (median [IQR])\"),\n                   quote = F, \n                   noSpaces = T, \n                   # smd = T, \n                   # missing = T, \n                   test = F, \n                   contDigits = 1, \n                   printToggle = F,\n                   dropEqual = T, \n                   explain = F)\n```\n:::\n\n\n`custom_tab()` needs a dataframe as argument, so first we convert the tableone object\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert to dataframe\ntab1_df <- as.data.frame(tab1_word) %>% rownames_to_column(var = \"Variable\")\n```\n:::\n\n\nUse `custom_tab()` to export the MS Word table.  \n**Important:** run `customtab_defaults()` before using the `custom_tab()` function to get correct formatting \n\n::: {.cell}\n\n```{.r .cell-code}\n# Rename first variable from n to No.\ntab1_df$Variable[1] <- \"No.\"\n\n# Set Table header\nheader <- str_squish(str_remove(\"Table 1. Baseline characteristics of 686 \n                                patients enrolled in the German Breast Cancer Study Group \n                                between 1984 and 1989\", \"\\n\"))\n\n# Set Table footer\nfooter <- str_squish(str_remove(\"Numbers are No. (%) unless otherwise noted. \n                                SD = standard deviation, fmol/L = femtomole per liter, \n                                IQR = interquartile range\", \"\\n\"))\n\n# Set custom_tab() defaults\ncustomtab_defaults()\n\n# Create the flextable object\nflextable_1 <- custom_tab(tab1_df, header, footer)\n\nflextable_1\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-803a81f6{}.cl-8036d254{font-family:'Calibri';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8036d268{font-family:'Calibri';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-803838ce{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-803838ec{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-80384544{width:3.141in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 3pt solid rgba(255, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384545{width:1.289in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 3pt solid rgba(255, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384546{width:3.141in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0.25pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038454e{width:1.289in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0.25pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038454f{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384550{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384558{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384559{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038455a{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038455b{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384562{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384563{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384564{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038456c{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt dotted rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8038456d{width:3.141in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384576{width:1.289in;background-color:rgba(245, 245, 245, 1.00);vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0.25pt dotted rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384577{width:3.141in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80384578{width:1.289in;background-color:transparent;vertical-align: middle;border-bottom: 0.25pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-803a81f6'><thead><tr style=\"overflow-wrap:break-word;\"><th  colspan=\"4\"class=\"cl-80384544\"><p class=\"cl-803838ce\"><span class=\"cl-8036d254\">Table 1. Baseline characteristics of 686 patients enrolled in the German Breast Cancer Study Group between 1984 and 1989</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-80384546\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Variable</span></p></th><th class=\"cl-8038454e\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">Overall</span></p></th><th class=\"cl-8038454e\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">Placebo</span></p></th><th class=\"cl-8038454e\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">Treated</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038454f\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">No.</span></p></td><td class=\"cl-80384550\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">686</span></p></td><td class=\"cl-80384550\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">440</span></p></td><td class=\"cl-80384550\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">246</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-80384558\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Age, years (mean (SD))</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">53.1 (10.1)</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">51.1 (10.0)</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">56.6 (9.4)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038455a\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Postmenopausal</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">396 (57.7)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">209 (47.5)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">187 (76.0)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-80384562\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Tumor size, mm (mean (SD)</span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">29.3 (14.3)</span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">29.6 (14.4)</span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">28.8 (14.1)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-80384562\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Tumor grade</span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\"></span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\"></span></p></td><td class=\"cl-80384563\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038455a\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">   1</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">81 (11.8)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">48 (10.9)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">33 (13.4)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038455a\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">   2</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">444 (64.7)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">281 (63.9)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">163 (66.3)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038455a\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">   3</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">161 (23.5)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">111 (25.2)</span></p></td><td class=\"cl-8038455b\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">50 (20.3)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-80384564\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Positive lymph nodes, (n)</span></p></td><td class=\"cl-8038456c\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">5.0 (5.5)</span></p></td><td class=\"cl-8038456c\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">4.9 (5.6)</span></p></td><td class=\"cl-8038456c\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">5.1 (5.3)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-80384558\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Progesterone receptors, fmol/L (median [IQR])</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">32.5 [7.0, 131.8]</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">32.0 [7.0, 130.0]</span></p></td><td class=\"cl-80384559\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">35.0 [7.2, 133.0]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8038456d\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Estrogen receptors, fmol/L (median [IQR])</span></p></td><td class=\"cl-80384576\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">36.0 [8.0, 114.0]</span></p></td><td class=\"cl-80384576\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">32.0 [8.0, 92.2]</span></p></td><td class=\"cl-80384576\"><p class=\"cl-803838ec\"><span class=\"cl-8036d268\">46.0 [9.0, 182.5]</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"4\"class=\"cl-80384577\"><p class=\"cl-803838ce\"><span class=\"cl-8036d268\">Numbers are No. (%) unless otherwise noted. SD = standard deviation, fmol/L = femtomole per liter, IQR = interquartile range</span></p></td></tr></tfoot></table></div>\n```\n:::\n:::\n\n\nSave the resulting table as .docx\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save as word .docx\nsave_as_docx(flextable_1, path = \"flextab_1.docx\", \n             pr_section = \n               prop_section(page_size = page_size(orient = \"portrait\"), \n                                       type = \"continuous\"))\n```\n:::\n\n\n\nThis will generate the following MS Word Table: \n\n![Custom Table](tableone.png)\n\nThe `customtab_defaults()` function simply sets some defaults for your tables, and can be changed to match the requirements of the journal you will be submitting to\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncustomtab_defaults <- function(){\n  set_flextable_defaults(font.family = \"Calibri\", \n  font.size = 10, \n  border.color = \"black\")\n}\n```\n:::\n\n\nThe `custom_tab()` function looks like this\n\n\n::: {.cell}\n\n```{.r .cell-code}\n######### Create default BioAVR table from dataframe\n#\n# Dependencies : dplyr, flextable, officer\n#      \ncustom_tab <- function(df, header, footer){\n  flextable(df) %>% \n    add_header_lines(header) %>% \n    add_footer_lines(footer) %>% \n    bold(i = 1, part = \"header\") %>% \n    hline_top(part = \"header\", \n              border = fp_border(color = \"red\", \n                                 width = 3, \n                                 style = \"solid\")) %>% \n    hline(i = 1, \n          part = \"header\", \n          border = fp_border(color = \"black\", \n                             width = 0.25, \n                             style = \"solid\")) %>% \n    hline_top(part = \"body\", \n              border = fp_border(color = \"black\", \n                                 width = 0.25, \n                                 style = \"solid\")) %>% \n    hline_bottom(part = \"body\", \n                 border = fp_border(color = \"black\", \n                                    width = 0.25, \n                                    style = \"solid\")) %>% \n    hline_bottom(part = \"footer\", \n                 border = fp_border(color = \"black\", \n                                    width = 0.25, \n                                    style = \"solid\")) %>% \n    border_inner_h(part = \"body\", \n                   border = fp_border(color = \"black\", \n                                      width = 0.25, \n                                      style = \"dotted\")) %>% \n    autofit(part = \"body\") %>% \n    bg(part = \"body\", bg = \"#f5f5f5\") %>% \n    align(part = \"all\", align = \"center\") %>% \n    align(j = 1, part = \"all\", align = \"left\")\n}\n```\n:::\n\n\nWhat it does is:  \n1. Add header and footer  \n2. Make header bold  \n3. Adds red and black border for header  \n4. Adds black borders for footer  \n5. Adds dotted borders for body content  \n6. Adds gray background to body  \n\nThis is a standard design I go for in my tables, but it can of course be changed to your own or journal specific requirements. \nWhile `flextable` allows output to other formats as well, I generally only use this for MS Word output. The reason is that I've noticed problems with the borders when outputting to pdf or image formats.  \n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}